<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Drush | A required tool for developers and sysadmins. | by Rich Allen</title>
    <meta name="description" content="A presenation for showing the usefulness of drush on modern drupal projects." />
    <meta name="author" content="Rich Allen" />
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />
    <link href="/stylesheets/taoti.css" media="screen" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="bower_components/impress.js/favicon.png" />
    <link rel="bower_components/impress.js/apple-touch-icon" href="apple-touch-icon.png" />
    <link href="google-code-prettify/prettify.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="google-code-prettify/prettify.js"></script>
</head>
<body onload="prettyPrint()">
    <div id="impress">
        <div class="step slide">
            <h2>Drush:</h2><h3>A required tool for modern drupal developers and sysadmins.</h3>
            <h4>by Rich Allen and with Taoti Creative</h4>
        </div>
        <div class="step slide" data-x="1000">
            <h4>What is drush?</h4>
            <p>At it's simplest it's a command line tool for interacting and building components of drupal sites.</p>
        </div>
        <div class="step slide" data-x="2000">
            <h4>No really what can drush do?</h4>
            <ul>
                <li>Reset Accounts</li>
                <li>Export Data</li>
                <li>Trouble shoot production websites without having to actually log onto a device.</li>
                <li>
                    Deploy remotely. Don't deal with permissions and adding https connection strings
                    because dealing with multiple users and git is a pain.
                </li>
                <li>Lock down your devices to a single user.</li>
            </ul>
            <div class="notes">
                <ul>
                    <li>Mass account changes using sql</li>
                    <li>Don't need to install extra admin modules to sort users (bloat)</li>
                    <li>Export Data</li>
                    <li>More vbo bloat</li>
                    <li>Trouble shoot production websites without having to actually log onto a device.</li>
                    <li>drush wd-show lets you check error messages on multiple devices.</li>
                    <li>Deploy remotely. Don't deal with permissions and adding https connection strings
                        because dealing with multiple users and git is a pain.</li>
                    <li>Shell aliases, and site aliases let you do simple deployments.</li>
                    <li>For larger stuff use chef/salt/puppet/jenkins with drush to make them easier to write.</li>
                    <li>Lock down your devices to a single user.</li>
                    <li>Drush does a lot more. As mentioned earlier this is going to be a very high level overview
                    of a lot of small modules/tips/commands to demonstrate the verboseness of drush.</li>
                    <li>There are hundreds of examples out there.</li>
                </ul>
            </div>
        </div>
        <div class="step slide" data-x="3000">
            <h4>Drush Aliases</h4>
            <p>
                STOP for the love of kittens documenting server information/inventory outside of your project.
                Add an alias file. It's trivial, it lives in code so developers don't waste time searching
                for documentation and credentials.
            </p>
            <p>
                Full documentation at
                <a href="https://github.com/drush-ops/drush/blob/master/examples/example.aliases.drushrc.php">
                    https://github.com/drush-ops/drush/blob/master/examples/example.aliases.drushrc.php
                </a></p>
            <div class="notes">
                <ul>
                    <li>If you want to have extra documentation that's fine (yes there is too much but that's for
                    your team to decide) but EVERY project should have an alias file.</li>
                    <li>An alias file is just an inventory list of your environments.</li>
                    <li>Its very quick to write them</li>
                    <li>lets you quickly do common operations environments.</li>
                </ul>
            </div>
        </div>
        <div class="step slide" data-x="4000"><pre class="prettyprint">
/**
* @file
* somewebsite.aliases.drushrc.php
* Depends on the following env variables being set.
* Place in your ~/.drush/drushrc.php
* global $dev_user
* $dev_user = 'yourSSHUserName';
* Repeat for any other environments
* # ln -s $projectRoot/somewebsite/somewebsite.aliases.drushrc.php ~/.drush/
*/
global $dev_user;
global $blkmsh_user;
$home = drush_server_home();
$aliases['dev'] = array('env' => 'dev',
    'root' => '/var/www/vhosts/somewebsite.org/public/docroot',
    'uri' => 'http://user:pass@somewebsite.taotidev.com',
    'remote-user' => $dev_user,
    'remote-host' => 'somewebsite.taotidev.com',
);
$aliases['prod'] = array(
    'env' => 'prod',
    'root' => '/var/www/somewebsite.org/htdocs/docroot',
    'uri' => 'https://somewebsite.org',
    'remote-user' => $blkmsh_user,
    'remote-host' => 'somewebsite.org',
    'path-aliases' => array(
        '%drush' => '/optcd/scripts/drush',
        '%site' => 'sites/default/',
    ),
);
$aliases['vagrant'] = array(
    'root' => '/var/www/docroot',
    'uri' => 'http://somewebsite.vagrant',
    'remote-user' => 'vagrant',
    'remote-host' => 'somewebsite.vagrant',
    'ssh-options' => "-p 22 -i " . $home . "/.vagrant.d/insecure_private_key",
);
            </pre>
            <div class="notes">
                <ul>
                    <li>Few minimal things</li>
                    <li>$alias['env Name']</li>
                    <li>root, uri, remote-user, remote-host</li>
                    <li>%drush, tell drush where remote drush lives, then you can let developers choose what
                    what version of drush to use. useful with composer.</li>
                    <li>ssh-options, specify keys, jump hosts, keys, etc.</li>
                </ul>
            </div>
        </div>
        <div class="step slide" data-x="5000">
            <h4>Ever update your project? Need fine tune control of versioning?</h4>
            <ul>
                <li>Drupal.org has structure that allows you to download any version of a project including
                    dev and beta releases that drush hooks into.
                </li>
                <li>
                    Combine with drush make to get the correct release with the patches you
                    need.
                </li>
                <li>Update your sites quickly and easily.
                    <pre class="prettyprint">
$drush @sitename.local up --lock=media,fieldcollection,mediacrop
$drush @sitename.local test-run --xml=/path/to/jenkins
                    </pre>
                </li>
            </ul>
            <p>Using git alone and updating by downloading and placing files you are almost promised that at some point
            you will loose a patch or get non-dev version when you need it for functionality.</p>
            <div class="notes">
                <ul>
                    <li>As hard as it is to find stuff on drupal.org the projects are organized pretty well.</li>
                    <li>Most contributed modules follow pretty decent branching schemes</li>
                    <li>There are times though where there is so much dev going on, or so little we are forced to use
                    dev/alpha branches or write grab patches.</li>
                    <li>where do you put patches? What do you do about future deployments.</li>
                    <li>Drush is the tool</li>
                    <li>for when you need a dev branch --lock is invaluable</li>
                    <li>invoke your testing through drush and get simple xml files to pass along to your CI tools</li>
                    <li>Any active project is going to bring on/loose developers. We can hope that everyone is perfect
                    and reads all the documentation. (probably not a good idea)</li>
                    <li>or you can include your lock file in the project so you have to specify when it's time to update
                    </li>
                </ul>
            </div>
        </div>
        <div class="step slide" data-x="6000">
            <h2>Question.</h2>
            <p>You and your team developers would never overwite php.ini memory limits just to import a large file or
                particularly large set of bash files right? Right?</p>
        </div>
        <div class="step slide" data-x="7000">
            <h4>STOP overriding php.ini settings. To upload crap
                like database backups, large files, or large imports.</h4>
            <p>
                <img src="images/badroblowe.jpg" style="float:left; margin-right: 10px; width: 580px">Don't be this Guy.
                Use php-cli.ini and run your operations through separate user. The bad decision Rob Lowe leads to memory
                hungry applications.
            </p>
            <div class="notes"><ul>
                <li>STOP overriding php.ini settings. To upload crap
                    like database backups, large files, or large imports.</li>
                <li>There is a php-cli for a reason.</li>
                <li>There are security risks, developers do dumb things.</li>
                <li>In a perfect world your team would be 5 superstars with core commits and a deep knowledge base
                in php.</li>
                <li>The real world we hire a range of skill levels and even the best screw up.</li>
                <li>lets say you need run a script in that aggregates data from an outside endpoint.</li>
                <li>we run this from the gui but turns out we have too many inputs so we change max_input_variable</li>
                <li>dev quickly uses find and replace but somehow ends up also changing max_filesize variable.</li>
                <li>this goes unnoticed for 6 months, and then all of a sudden you have unstable crashing devices
                with no disk space. SPAMMERS have found your site! Fun fun</li>
                <li>have fun with that fire. first you have to figure out why the device is down (ssh tends to die
                with a full disk)</li>
                <li>then remove the files without altering your end users content. (hope your good on the command line)
                </li>
                <li>It's a fire that could have been avoided. Invoke the script through drush, have your cli-settings
                separate from your application.</li>
            </ul></div>
        </div>
        <div class="step slide" data-x="8000">
            <h4>What developers are missing.</h4>
            <p>The first and biggest thing is writing code over and over again.(yes I'm starting in drush contrib).<br>
                <a href="https://www.drupal.org/project/module_builder">
                    https://www.drupal.org/project/module_builder
                </a>
                and for Drupal 8 <a href="https://www.drupal.org/project/console">
                    https://www.drupal.org/project/console
                </a>(not drush, works the same though)
            </p>
            <pre class="prettyprint">
$drush @sitename.local mb my_module menu cron form form_alter permissions
menu_alter update install --write --name="My module" --dep="forum views"
            </pre>
        </div>
        <div class="step slide" data-x="9000" data-y="20000"data-scale="10.4">
            <pre style="overflow-y:auto; height: 600px;font-size: 10px;"class="prettyprint" >
/**
 * @file somesite_simulation.module
 * This file defines most parts of our simulation. At this moment it's just a
 * form alter but contains scaffolding for defining defaults, field types,
 * etc. There is going to be a part where we need to set up the default
 * values for the administrators on install otherwise we'll end up using
 * a node import if needed.
 */

define('YEAR_IN_HOURS', (float)8760);

/**
 * Implements hook_menu().
 */
function somesite_simulation_menu() {
  $items = array();

  $items['admin/config/simulation'] = array(
    'title' => 'Administer Simulation',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('somesite_simulation_settings_form'),
    'access arguments' => array('administer somesite_simulation'),
  );
  return $items;
}

/**
 * Implements hook_permission().
 */
function somesite_simulation_permission() {
  return array(
    'administer somesite simulation' =>  array(
      'title' => t('Administer somesite Module'),
      'description' => t('Perform administration tasks for somesite Simulation.'),
    ),
  );
}

/**
 * Implements hook_field_info().
 */
function somesite_simulation_field_info() {
  return array(
    'text' => array(
      'label' => t('Text'),
      'description' => t('This field stores varchar text in the database.'),
      'settings' => array('max_length' => 255),
      'instance_settings' => array('text_processing' => 0),
      'default_widget' => 'text_textfield',
      'default_formatter' => 'text_default',
    ),
    'text_long' => array(
      'label' => t('Long text'),
      'description' => t('This field stores long text in the database.'),
      'settings' => array('max_length' => ''),
      'instance_settings' => array('text_processing' => 0),
      'default_widget' => 'text_textarea',
      'default_formatter' => 'text_default',
    ),
    'text_with_summary' => array(
      'label' => t('Long text and summary'),
      'description' => t('This field stores long text in the database along with optional summary text.'),
      'settings' => array('max_length' => ''),
      'instance_settings' => array('text_processing' => 1, 'display_summary' => 0),
      'default_widget' => 'text_textarea_with_summary',
      'default_formatter' => 'text_summary_or_trimmed',
    ),
  );
}

/**
 * Implements hook_field_schema().
 */

function somesite_simulation_field_schema($field) {
  if ($field['type'] == 'text_long') {
    $columns = array(
      'value' => array(
        'type' => 'text',
        'size' => 'big',
        'not null' => FALSE,
      ),
    );
  }
  else {
    $columns = array(
      'value' => array(
        'type' => 'varchar',
        'length' => $field['settings']['max_length'],
        'not null' => FALSE,
      ),
    );
  }
  $columns += array(
    'format' => array(
      'type' => 'varchar',
      'length' => 255,
      'not null' => FALSE,
    ),
  );
  return array(
    'columns' => $columns,
    'indexes' => array(
      'format' => array('format'),
    ),
    'foreign keys' => array(
      'format' => array(
        'table' => 'filter_format',
        'columns' => array('format' => 'format'),
      ),
    ),
  );
}
*/

/**
 * Implements hook_field_validate().
 */

function somesite_simulation_field_validate($entity_type, $entity, $field, $instance, $langcode, $items, &$errors) {
  foreach ($items as $delta => $item) {
    if (!empty($item['value'])) {
      if (!empty($field['settings']['max_length']) && drupal_strlen($item['value']) > $field['settings']['max_length']) {
        $errors[$field['field_name']][$langcode][$delta][] = array(
          'error' => 'text_max_length',
          'message' => t('somesite Simulation: the value may not be longer than %max characters.', array('somesite Simulation' => $instance['label'], '%max' => $field['settings']['max_length'])),
        );
      }
    }
  }
}

/**
 * Implements hook_field_is_empty().
 */

function somesite_simulation_field_is_empty($item, $field) {
  if (empty($item['value']) && (string) $item['value'] !== '0') {
    return TRUE;
  }
  return FALSE;
}

/**
 * Implements hook_field_update_forbid().
 */

function somesite_simulation_field_update_forbid($field, $prior_field, $has_data) {
  // A 'list' field stores integer keys mapped to display values. If
  // the new field will have fewer values, and any data exists for the
  // abandoned keys, the field will have no way to display them. So,
  // forbid such an update.
  if ($has_data && count($field['settings']['allowed_values']) < count($prior_field['settings']['allowed_values'])) {
    // Identify the keys that will be lost.
    $lost_keys = array_diff(array_keys($field['settings']['allowed_values']), array_keys($prior_field['settings']['allowed_values']));
    // If any data exist for those keys, forbid the update.
    $query = new EntityFieldQuery();
    $found = $query
      ->fieldCondition($prior_field['field_name'], 'value', $lost_keys)
      ->range(0, 1)
      ->execute();
    if ($found) {
      throw new FieldUpdateForbiddenException("Cannot update a list field not to include keys with existing data");
    }
  }
}

/**
 * Implements hook_field_update_field().
 */

function somesite_simulation_field_update_field($field, $prior_field, $has_data) {
  // Reset the static value that keeps track of allowed values for list fields.
  drupal_static_reset('list_allowed_values');
}

/**
 * Implements hook_field_settings_form().
 */
function somesite_simulation_field_settings_form($field, $instance, $has_data) {
  $settings = $field['settings'];
  $form['max_length'] = array(
    '#type' => 'textfield',
    '#title' => t('Maximum length'),
    '#default_value' => $settings['max_length'],
    '#required' => FALSE,
    '#element_validate' => array('element_validate_integer_positive'),
    '#description' => t('The maximum length of the field in characters. Leave blank for an unlimited size.'),
  );
  return $form;
}

/**
 * Implements hook_field_instance_settings_form().
 */

function somesite_simulation_field_instance_settings_form($field, $instance) {
  $settings = $instance['settings'];

  $form['text_processing'] = array(
    '#type' => 'radios',
    '#title' => t('Text processing'),
    '#default_value' => $settings['text_processing'],
    '#options' => array(
      t('Plain text'),
      t('Filtered text (user selects text format)'),
    ),
  );
  if ($field['type'] == 'text_with_summary') {
    $form['display_summary'] = array(
      '#type' => 'select',
      '#title' => t('Display summary'),
      '#options' => array(
        t('No'),
        t('Yes'),
      ),
      '#description' => t('Display the summary to allow the user to input a summary value. Hide the summary to automatically fill it with a trimmed portion from the main post.'),
      '#default_value' => !empty($settings['display_summary']) ? $settings['display_summary'] :  0,
    );
  }

  return $form;
}

/**
 * Implements hook_node_info().
 */

function somesite_simulation_node_info() {
  return array(
    'blog' => array(
      'name' => t('Blog entry'),
      'base' => 'blog',
      'description' => t('Use for multi-user blogs. Every user gets a personal blog.'),
    )
  );
}

/**
 * Implements hook_delete().
 */

function somesite_simulation_delete($node) {
  db_delete('mytable')
    ->condition('nid', $node->nid)
    ->execute();
}

/**
 * Implements hook_form().
 */

function somesite_simulation_form($node, &$form_state) {
  $type = node_type_get_type($node);

  $form['title'] = array(
    '#type' => 'textfield',
    '#title' => check_plain($type->title_label),
    '#default_value' => !empty($node->title) ? $node->title : '',
    '#required' => TRUE, '#weight' => -5
  );

  $form['field1'] = array(
    '#type' => 'textfield',
    '#title' => t('Custom field'),
    '#default_value' => $node->field1,
    '#maxlength' => 127,
  );
  $form['selectbox'] = array(
    '#type' => 'select',
    '#title' => t('Select box'),
    '#default_value' => $node->selectbox,
    '#options' => array(
      1 => 'Option A',
      2 => 'Option B',
      3 => 'Option C',
    ),
    '#description' => t('Choose an option.'),
  );

  return $form;
}

/**
 * Implements hook_insert().
 */

function somesite_simulation_insert($node) {
  db_insert('mytable')
    ->fields(array(
      'nid' => $node->nid,
      'extra' => $node->extra,
    ))
    ->execute();
}

/**
 * Implements hook_load().
 */

function somesite_simulation_load($nodes) {
  $result = db_query('SELECT nid, foo FROM {mytable} WHERE nid IN (:nids)', array(':nids' => array_keys($nodes)));
  foreach ($result as $record) {
    $nodes[$record->nid]->foo = $record->foo;
  }
}

/**
 * Implements hook_update().
 */

function somesite_simulation_update($node) {
  db_update('mytable')
    ->fields(array('extra' => $node->extra))
    ->condition('nid', $node->nid)
    ->execute();
}

/**
 * Implements hook_validate().
 */

function somesite_simulation_validate($node, $form, &$form_state) {
  if (isset($node->end) && isset($node->start)) {
    if ($node->start > $node->end) {
      form_set_error('time', t('An event may not end before it starts.'));
    }
  }
}


/**
 * Implements hook_view().
 */

function somesite_simulation_view($node, $view_mode) {
  if ($view_mode == 'full' && node_is_page($node)) {
    $breadcrumb = array();
    $breadcrumb[] = l(t('Home'), NULL);
    $breadcrumb[] = l(t('Example'), 'example');
    $breadcrumb[] = l($node->field1, 'example/' . $node->field1);
    drupal_set_breadcrumb($breadcrumb);
  }

  $node->content['myfield'] = array(
    '#markup' => theme('mymodule_myfield', $node->myfield),
    '#weight' => 1,
  );

  return $node;
}

/**
 * Form builder.
 */
function somesite_simulation_settings_form($form, &$form_state) {
  $form['somesite_simulation_variable_foo'] = array(
    '#type' => 'textfield',
    '#title' => t('Foo'),
    '#default_value' => variable_get('somesite_simulation_variable_foo', 42),
    '#required' => TRUE,
  );

  // TODO! You probably don't need validation or submit handlers if using system_settings_form().
  return system_settings_form($form);
}

/**
 * Form validate handler.
 */
function somesite_simulation_settings_form_validate($form, &$form_state) {
  if ($form_state['values']['element'] != 'hello') {
    form_set_error('element', t('Please say hello?'));
  }
}

/**
 * Form submit handler.
 */
function somesite_simulation_settings_form_submit($form, &$form_state) {

}
            </pre>
            <div class="notes"><ul>
                <li>This is ~300 line of scaffolding code. With examples.</li>
                <li>Tech leads/senior devs can use this to write plans for others who may be doing work.</li>
                <li>Here is a module with the hooks you need and examples.</li>
                <li>Great way for younger developers to learn and take on complex tasks without having to make key
                decision on how to approach a problem.</li>
                <li>Save your leads time for the really important tasks</li>
                <li>Also writes test files for each module, creates you info files and asks you for the key information
                </li>
                <li>The console project is a drupal 8 addition that stems from module builder.</li>
                <li>Without going into detail drush has major structural changes that allow for a modern scaffolding
                tool. It's in beta but it allows you to write very verbose and specific configuration in code.</li>
                <li>Both these tools are based off of the codebase you are invoking from so these hooks update
                with drupal. UNLIKE your developer.</li>
            </ul></div>
        </div>
        <div class="step slide" data-x="10000">
            <h4>Export config from multiple environment using ctools and features. Don't wait for 'status' of
                a feature.
            </h4>
            <p>Large sites with lots of features are slow to work with. Features UI is PAINFULLY slow.</p>
            <p>Everytime you navigate to see the status of your feature it can take minutes per load. This
            can very easily add to hours of overhead when troubleshooting configuration.</p>
            <pre class="prettyprint">
$drush @sitename.local features-diff feature_name</pre>
            <div class="notes"><ul>
                <li>Don't get me wrong. I use features daily, it's a great module and the folks who write/maintain it
                    are far far smarter than I am but none the less it's a hack on an design decision to keep
                    drupal accessible without code.</li>
                <li>Drupal 8 should improve this situation but features are slow, and painful to write
                consistently.</li>
                <li>Add multiple developers using features and I can easily say configuration of applications
                and the management of features is the single biggest daily pain in the butt that I and many others
                deal with daily.</li>
                <li>Drush has tools to help and speed up this process.</li>
                <li>I'm not kidding when I say features get slow. Head to the main features page. Depending on your
                application this can take 5 minutes to refresh. If you have to build a new configuration over
                several features you can loose hours in a day just refreshing, clearing cache, making sure you got all
                the overrides, etc.</li>
                <li>This also doesn't mean your site was built incorrectly. It is simply the result of having to load
                multiple configuration states, and comparing at once.</li>
                <li>Knowing that, avoid the issue. Stop loading all the features, load what you need, and write what
                need.</li>
                <li>drush features diff is great.</li>
                <li>First your running it from the command line. Use those 16GB of memory (if you are so lucky). It's
                just faster then adding in the gui part.</li>
                <li>pick a single feature to work with. the syntax is stupid simple (for a dev, I realize nothing
                we do is really simple)</li>
                <li>There is no other choice other than not using features and sticking with only ctools exportables
                which funny story. puts your config permanently into code completely invalidating one of the primary
                reasons for drupal. It has a gui and the client end users can config things.</li>
            </ul>
            </div>
        </div>
        <div class="step slide" data-x="11000">
            <h4>Another example: I need to recreate code that is over several features!</h4>
            Without drush:
            <ul>
                <li>Wait for features page to show status, find overridden.</li>
                <li>Click recreate/download</li>
                <li>Repeat x times</li>
            </ul>
            With drush: <pre class="prettyprint">
$drush @sitename.local features-update-all -y</pre>
            <img src="images/compiling.png">
            <div class="notes"><ul>
                <li>As primaraly a php developer, I thank features for allowing me to plaster this graphic at
                my desk.</li>
                <li>8 features, at 5 minutes on a page reload. In a perfect world where you got every piece of config
                and don't forget anything this means you are dealing with at least an hour long task. For what
                can be done in a few minutes.</li>
            </ul></div>
        </div>
        <div class="step slide" data-x="12000">
            With drush and nix magic (probably want to alias this one):
            <pre class="prettyprint">
$drush features-update | grep -E 'Overridden[[:space:]]+$' \|
sed -E 's/[[:space:]]*Enabled[[:space:]]*Overridden[[:space:]]*//' \ |
sed -E 's/.*[[:space:]]//' \| xargs drush features-diff
            </pre>
            This line of code has saved me personally hundreds of hours. You wouldn't believe how much time waiting
            for feature status can eat away 1-2 minutes at a time.
            <div class="notes"><ul>
                <li>oh god whats that</li>
                <li>Don't be scared but yeah you probably don't want to be figuring out this command. Alias it. 30
                seconds for each developer.</li>
                <li>the too long don't understand sed and awk version of this is get me all of my overridden features
                and rebuild them.</li>
                <li>Did you change a view and the developer is complaining that it will go away next week? (cause we
                complain a lot I know)?</li>
                <li>git checkout -b new branch, drush sql-sync, followed buy this one command.</li>
                <li>it aint lighting fast but it's quicker then a 20 minute features-update-all</li>
            </ul></div>
        </div>
        <div class="step slide" data-x="13000">
            <h4>Moving databases....constantly.</h4>
            <p>Drupal config is a pain because of how it's set up we are constantly moving databases around. Do this
                the smart way.
                <pre class="prettyprint">$drush sql-sync @somesite.live @somesite.local</pre></p>
            <p>Or you could do this....</p>
            <div class="notes"><ul>
                <li>Does your team move databases around a lot? probably</li>
                <li>I know we're back to this, but it's true.</li>
                <li>so here is the easy way that I hinted back on the last slide</li>
                <li>use aliases to backup and move databases from environment quickly. stop wearing out your scp
                keys.</li>
            </ul></div>
        </div>
        <div class="step slide" data-x="14000">
            <h4>It's your call</h4>
            <p>
                <pre style="float:left; margin-right: 10px; margin-top: 0px; display: inline;" class="prettyprint shell">
$ssh remoteEnv
$cat /var/www/drupal/sites/default/settings.php #check settings.php for table name
$mysqldump -uDrupal -p tablename > ~/somefile.sql
$exit
$scp remoteEnv:~/somefile.sql ~/Downloads
$scp ~/Downloads/somefile.sql localEnv:~/
$ssh localEnv
$cat /var/www/docroot/drupal/sites/default/settings.php
$mysql -uSomeNewDrupalUser -p anotherNewTable < ~/somefile.sql
                </pre><img style="display: inline;"src="images/no.gif">
            <div class="notes"><ul>
                <li>Seriously this is craziness.</li>
                <li>Not all of your developers are going to be great on the command line so then you just install
                things like phpmyadmin and backup migrate. Which suffer the same configuration issues as anything
                from in the application.</li>
            </ul></div>
        </div>
        <div class="step slide" data-x="15000">
            <h4>Moving content</h4>
            <p>No reason to ever build a vbo view for exporting content. Use drush.</p>
            <p><pre class="prettyprint">
$drush @sitename.live ne-node-export
--sql="SELECT nid FROM node where type='your_content_type' and status=0" >
~/myoutput.xml</pre></p>
            <p>Need to debug a node on a live site? Don't want to pull down a 5GB db dump to your local? Don't want
            to enable devel and debug on prod?</p><p><pre class="prettyprint">$drush @sitename.live ev "print_r(node_load(123);"</pre></p>
        </div>
        <div class="step slide" data-x="16000">
            <h4>Continuous Integration</h4>
            <p>Drush is a linchpin in the deployment process. Manual deployments work for simple sites but what
            happens when you have 10 codebases and 4 databases behind load balancers?</p>
            <p>Don't make your CI a collection of scripts for different servers. It's a mess.Remember this?</p>
            <pre class="prettyprint">$drush sql-sync @sitename.staging @sitename</pre>
            <p>Push your database to all environments/masters/slaves in one go.<br>
            Drush aliases have hierarchy which allows you to deploy to sub/supersets depending on how you configure.</p>
            <div class="notes"><ul>
                <li>it just takes a little time to set up your aliases so you can deploy how your team would like
                without having to write code for full on deployment tools</li>
                <li> if you are using full on deployment tools drush makes these tools easier to work with</li>
            </ul></div>
        </div>
        <div class="step slide" data-x="17000">
            <p>An example of using drush with ansible to get the status of every single one of your sites.</p>
            <pre class="prettyprint">
---
- hosts: drupal7
  gather_facts: False

  tasks:
    - name: Drupal 7 Sites
      shell: >
        drush status
        chdir={{docroot}}
      register: result

    - debug: var=result.stdout_lines



// The following would normally be in a separate
//inventory file but I have it laid out here so
//you can see how it works.
[drupal7]
americansall.org docroot=/var/www/site1/htdocs/docroot/
americaabroadmedia.org docroot=/var/www/site2/htdocs/docroot
//etc
            </pre>
            <div class="notes"><ul>
                <li>ansible is a program installed on a developers machine. no need to configure</li>
                <li>on osx hombrew install ansible, on debian apt-get install ansible</li>
                <li>create you inventory list, you can now check the status of all of your devices</li>
                <li>this in itself isn't very useful for most folks here but it's an example of the power and ease
                of creating tools to work with drush to keep your application healthy</li>
            </ul></div>
        </div>
        <div class="step slide" data-x="18000">
            <h4>Site hacked?</h4>
            <p>Don't try to sanitize your server. We all know (or should) that it's trivially easy to miss some php file
            on the server running somewhere that will just redo the damage.</p>
            <p>Use drush make to rebuild your servers quick and efficiently. Then you just have to worry about the
            database which is easier and safer to sanitize.</p>
            <pre class="prettyprint">
$drush make mysitemakefile.make
$drush site-install --db-url=account:pass@Hostname/dbName
$drush sql-connect < sanitizedDB.sql
$drush pm-enable -y stage_file_proxy
$drush variable-set stage_file_proxy_origin "http://oldsite.org/"
            </pre>
        </div>
        <div class="step slide" data-x="19000">
            <h4>Lock down your servers. Simplify Security</h4>
            <p>There is no reason for you to log on to a server. Drush gives you the tools to work remotely
            using aliases. One user that can only execute a subset of commands.<br> 1 key to rotate, no one altering
                configuration while trying to troubleshoot.
            </p>
        </div>
    </div>
    <!-- End impress container -->
<script src="bower_components/impress.js/js/impress.js"></script>
<script src="js/impress-console/js/impressConsole.js"></script>
<script>impress().init();</script>
<script>impressConsole().init(css="js/impress-console/css/impressConsole.css");</script>
</body>
